{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrastyle %}
{{ block.super }}
<style>
.dashboard-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.dashboard-card {
    background: white;
    border-radius: 12px;
    padding: 25px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-left: 4px solid var(--primary);
    transition: transform 0.2s ease;
}

.dashboard-card:hover {
    transform: translateY(-2px);
}

.dashboard-card h3 {
    margin: 0 0 15px 0;
    color: var(--primary);
    font-size: 1.2em;
}

.dashboard-card .count {
    font-size: 2.5em;
    font-weight: bold;
    color: var(--primary);
    margin: 10px 0;
}

.dashboard-card .description {
    color: var(--secondary);
    margin: 0;
}

.dashboard-card.quick-actions {
    border-left-color: var(--accent);
}

.quick-links {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-top: 15px;
}

.quick-links a {
    background: var(--primary);
    color: white;
    padding: 10px;
    text-align: center;
    text-decoration: none;
    border-radius: 6px;
    transition: background 0.2s ease;
}

.quick-links a:hover {
    background: #3730a3;
}
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="dashboard-card">
        <h3><i class="fas fa-users me-2"></i>Пользователи</h3>
        <div class="count">{{ user_count }}</div>
        <p class="description">Всего зарегистрированных пользователей</p>
    </div>

    <div class="dashboard-card">
        <h3><i class="fas fa-book me-2"></i>Курсы</h3>
        <div class="count">{{ course_count }}</div>
        <p class="description">Образовательных курсов</p>
    </div>

    <div class="dashboard-card">
        <h3><i class="fas fa-file-alt me-2"></i>Уроки</h3>
        <div class="count">{{ lesson_count }}</div>
        <p class="description">Учебных материалов</p>
    </div>

    <div class="dashboard-card">
        <h3><i class="fas fa-tasks me-2"></i>Задания</h3>
        <div class="count">{{ assignment_count }}</div>
        <p class="description">Учебных заданий</p>
    </div>
</div>

<div class="dashboard-card quick-actions">
    <h3><i class="fas fa-bolt me-2"></i>Быстрые действия</h3>
    <div class="quick-links">
        <a href="/admin/core/course/add/">
            <i class="fas fa-plus me-1"></i>Создать курс
        </a>
        <a href="/admin/core/lesson/add/">
            <i class="fas fa-file-alt me-1"></i>Добавить урок
        </a>
        <a href="/admin/core/assignment/add/">
            <i class="fas fa-tasks me-1"></i>Создать задание
        </a>
        <a href="/admin/auth/user/add/">
            <i class="fas fa-user-plus me-1"></i>Добавить пользователя
        </a>
    </div>
</div>

{{ block.super }}
{% endblock %}

{% block sidebar %}
<div id="content-related">
    <div class="module" id="recent-actions-module">
        <h2>Последние действия</h2>
        {% load log %}
        {% get_admin_log 10 as admin_log for_user user %}
        {% if not admin_log %}
        <p>Нет действий</p>
        {% else %}
        <ul class="actionlist">
        {% for entry in admin_log %}
        <li class="{% if entry.is_addition %}addlink{% endif %}{% if entry.is_change %}changelink{% endif %}{% if entry.is_deletion %}deletelink{% endif %}">
            {% if entry.is_deletion or not entry.get_admin_url %}
                {{ entry.object_repr }}
            {% else %}
                <a href="{{ entry.get_admin_url }}">{{ entry.object_repr }}</a>
            {% endif %}
            <br>
            {% if entry.content_type %}
                <span class="mini quiet">{% filter capfirst %}{{ entry.content_type.name }}{% endfilter %}</span>
            {% else %}
                <span class="mini quiet">Неизвестный контент</span>
            {% endif %}
        </li>
        {% endfor %}
        </ul>
        {% endif %}
    </div>
</div>
{% endblock %}